dependencies:
  pre:
    - sudo apt-get install luajit
    - sudo apt-get install luarocks
    - sudo luarocks install luasec OPENSSL_LIBDIR=/usr/lib/x86_64-linux-gnu/
    - sudo luarocks install busted 1.11.1-2
    - sudo luarocks install luacov-coveralls --server=http://rocks.moonscript.org/dev
test:
  override:
    - mkdir $CIRCLE_TEST_REPORTS/busted
    - busted -c --output=junit spec > $CIRCLE_TEST_REPORTS/busted/promise.xml
  post:
    - luacov-coveralls -c spec/.luacov